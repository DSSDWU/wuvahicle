html
<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ระบบขึ้นทะเบียนขอใช้รถ มหาวิทยาลัยวลัยลักษณ์</title>
    
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- SweetAlert2 for beautiful alerts -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <!-- Google Fonts for Thai characters -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;500;700&display=swap" rel="stylesheet">
    
    <style>
        /* Custom styles */
        body {
            font-family: 'Sarabun', sans-serif;
            background-color: #f0fdf4; /* Very light green background */
        }
        .form-label {
            @apply block text-gray-700 text-sm font-bold mb-2;
        }
        .form-input, .form-select {
            @apply shadow appearance-none border rounded-lg w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline focus:ring-2 focus:ring-green-500;
        }
        .form-input:disabled, .form-select:disabled {
            @apply bg-gray-200 cursor-not-allowed;
        }
        .btn-submit {
            @apply bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg focus:outline-none focus:shadow-outline w-full transition-colors duration-300;
        }
        .btn-submit:disabled {
            @apply bg-gray-400 cursor-not-allowed;
        }
        .form-section {
            @apply bg-white p-6 rounded-xl shadow-md mb-6;
        }
        .error-message {
            @apply text-red-500 text-xs mt-1;
        }
        .image-preview {
            @apply mt-2 border-2 border-dashed border-gray-300 rounded-lg p-2 w-full h-48 object-contain hidden;
        }
    </style>
</head>
<body class="antialiased">
    <div class="container mx-auto p-4 max-w-3xl">
        <!-- Header -->
        <header class="text-center my-6">
            <img src="https://www.wu.ac.th/uploads/logoWU_1631668089.png" alt="Walailak University Logo" class="h-20 mx-auto mb-4">
            <h1 class="text-2xl md:text-3xl font-bold text-green-800">ระบบขึ้นทะเบียนขอใช้รถ</h1>
            <p class="text-gray-600">มหาวิทยาลัยวลัยลักษณ์</p>
        </header>

        <!-- Form -->
        <form id="vehicleForm" class="space-y-4">
            <!-- Part 1: Personal Information -->
            <div class="form-section">
                <h2 class="text-xl font-bold text-green-700 border-b-2 border-green-200 pb-2 mb-4">ส่วนที่ 1: ข้อมูลส่วนตัว</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="form-label" for="studentId">รหัสนักศึกษา</label>
                        <input class="form-input" id="studentId" type="text" placeholder="กรอกรหัส 8 หลัก" required>
                        <p id="studentIdError" class="error-message hidden">กรุณากรอกรหัสนักศึกษา 8 หลัก เป็นตัวเลขเท่านั้น</p>
                    </div>
                    <div>
                        <label class="form-label" for="fullName">ชื่อ-สกุล</label>
                        <input class="form-input" id="fullName" type="text" placeholder="ชื่อ-สกุล" required>
                    </div>
                    <div class="md:col-span-2">
                        <label class="form-label" for="faculty">สำนักวิชา</label>
                        <select class="form-select" id="faculty" required>
                            <option value="" disabled selected>-- กรุณาเลือกสำนักวิชา --</option>
                            <option>การจัดการ</option>
                            <option>การบัญชีและการเงิน</option>
                            <option>เทคโนโลยีการเกษตรและอุตสาหกรรมอาหาร</option>
                            <option>นิติศาสตร์</option>
                            <option>พยาบาลศาสตร์</option>
                            <option>แพทยศาสตร์</option>
                            <option>เภสัชศาสตร์</option>
                            <option>รัฐศาสตร์และรัฐประศาสนศาสตร์</option>
                            <option>วิทยาศาสตร์</option>
                            <option>วิศวกรรมศาสตร์และเทคโนโลยี</option>
                            <option>ศึกษาศาสตร์</option>
                            <option>ศิลปศาสตร์</option>
                            <option>สถาปัตยกรรมศาสตร์และการออกแบบ</option>
                            <option>สหเวชศาสตร์</option>
                            <option>สาธารณสุขศาสตร์</option>
                            <option>สารสนเทศศาสตร์</option>
                            <option>วิทยาลัยทันตแพทยศาสตร์นานาชาติ</option>
                            <option>วิทยาลัยนานาชาติ</option>
                            <option>วิทยาลัยสัตวแพทยศาสตร์อัครราชกุมารี</option>
                        </select>
                    </div>
                    <div>
                        <label class="form-label" for="phone">หมายเลขโทรศัพท์</label>
                        <input class="form-input" id="phone" type="text" placeholder="0XXXXXXXXX" required>
                        <p id="phoneError" class="error-message hidden">กรุณากรอกเบอร์โทร 10 หลัก ขึ้นต้นด้วย 0</p>
                    </div>
                    <div>
                        <label class="form-label" for="residence">ที่พักปัจจุบัน</label>
                        <select class="form-select" id="residence" required>
                            <option value="" disabled selected>-- กรุณาเลือกที่พัก --</option>
                            <option>หอพักภายในมหาวิทยาลัย</option>
                            <option>หอพักภายนอกมหาวิทยาลัย</option>
                            <option>บ้านตนเอง</option>
                        </select>
                    </div>
                    <div class="md:col-span-2">
                        <label class="form-label" for="address">ที่อยู่</label>
                        <input class="form-input" id="address" type="text" placeholder="ชื่อหอพัก/บ้านเลขที่" required>
                        <p class="text-xs text-gray-500 mt-1">กรณีหอพัก ให้กรอกชื่อหอพักและหมายเลขห้อง / กรณีบ้านพัก ให้กรอกบ้านเลขที่และที่อยู่</p>
                    </div>
                    <div>
                        <label class="form-label" for="emergencyContactName">ผู้ติดต่อกรณีฉุกเฉิน</label>
                        <input class="form-input" id="emergencyContactName" type="text" placeholder="ชื่อ-สกุล ผู้ติดต่อ" required>
                    </div>
                    <div>
                        <label class="form-label" for="emergencyRelationship">ความสัมพันธ์</label>
                        <select class="form-select" id="emergencyRelationship" required>
                            <option value="" disabled selected>-- กรุณาเลือกความสัมพันธ์ --</option>
                            <option>บิดา/มารดา</option>
                            <option>ผู้ปกครอง</option>
                            <option>ญาติ</option>
                            <option>เพื่อน</option>
                        </select>
                    </div>
                    <div class="md:col-span-2">
                        <label class="form-label" for="emergencyPhone">เบอร์โทรศัพท์ฉุกเฉิน</label>
                        <input class="form-input" id="emergencyPhone" type="text" placeholder="0XXXXXXXXX" required>
                        <p id="emergencyPhoneError" class="error-message hidden">กรุณากรอกเบอร์โทร 10 หลัก ขึ้นต้นด้วย 0</p>
                    </div>
                     <div class="md:col-span-2">
                        <label class="form-label" for="license">ใบอนุญาตขับรถ</label>
                        <select class="form-select" id="license" required>
                            <option value="" disabled selected>-- กรุณาเลือก --</option>
                            <option>ไม่มีใบอนุญาตขับรถที่ขอขึ้นทะเบียน</option>
                            <option>มีใบอนุญาตขับรถที่ขอขึ้นทะเบียนแล้ว</option>
                            <option>รถที่ขอขึ้นทะเบียนเป็นจักรยานไฟฟ้า</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Part 2: Vehicle Information -->
            <div class="form-section">
                <h2 class="text-xl font-bold text-green-700 border-b-2 border-green-200 pb-2 mb-4">ส่วนที่ 2: ข้อมูลรถที่ขึ้นทะเบียน</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="form-label" for="vehicleType">ประเภทรถ</label>
                        <select class="form-select" id="vehicleType" required>
                            <option value="" disabled selected>-- กรุณาเลือกประเภทรถ --</option>
                            <option>รถยนต์(น้ำมัน)</option>
                            <option>รถยนต์ไฟฟ้า</option>
                            <option>รถจักรยานยนต์</option>
                            <option>รถจักรยานยนต์ไฟฟ้า</option>
                            <option>รถจักรยานไฟฟ้า</option>
                        </select>
                    </div>
                    <div>
                        <label class="form-label" for="vehicleBrand">ยี่ห้อรถ</label>
                        <input class="form-input" id="vehicleBrand" type="text" placeholder="เช่น Toyota, Honda" required>
                    </div>
                    <div>
                        <label class="form-label" for="vehicleModel">รุ่นรถ</label>
                        <input class="form-input" id="vehicleModel" type="text" placeholder="เช่น Vios, Wave" required>
                    </div>
                    <div>
                        <label class="form-label" for="licensePlate">ทะเบียนรถ</label>
                        <input class="form-input" id="licensePlate" type="text" placeholder="เช่น กข 1234" required>
                        <p class="text-xs text-gray-500 mt-1">ป้ายแดงกรอก "ป้ายแดง" / รถไม่มีทะเบียนกรอก "ไม่สามารถจดทะเบียนได้"</p>
                    </div>
                    <div class="md:col-span-2">
                        <label class="form-label" for="province">จังหวัด</label>
                        <select class="form-select" id="province" required>
                           <option value="" disabled selected>-- กรุณาเลือกจังหวัด --</option>
                            <option>ป้ายแดง</option>
                            <option>ไม่สามารถจดทะเบียนได้</option>
                            <option>กรุงเทพมหานคร</option>
                            <option>กระบี่</option>
                            <option>กาญจนบุรี</option>
                            <option>กาฬสินธุ์</option>
                            <option>กำแพงเพชร</option>
                            <option>ขอนแก่น</option>
                            <option>จันทบุรี</option>
                            <option>ฉะเชิงเทรา</option>
                            <option>ชลบุรี</option>
                            <option>ชัยนาท</option>
                            <option>ชัยภูมิ</option>
                            <option>ชุมพร</option>
                            <option>เชียงราย</option>
                            <option>เชียงใหม่</option>
                            <option>ตรัง</option>
                            <option>ตราด</option>
                            <option>ตาก</option>
                            <option>นครนายก</option>
                            <option>นครปฐม</option>
                            <option>นครพนม</option>
                            <option>นครราชสีมา</option>
                            <option>นครศรีธรรมราช</option>
                            <option>นครสวรรค์</option>
                            <option>นนทบุรี</option>
                            <option>นราธิวาส</option>
                            <option>น่าน</option>
                            <option>บึงกาฬ</option>
                            <option>บุรีรัมย์</option>
                            <option>ปทุมธานี</option>
                            <option>ประจวบคีรีขันธ์</option>
                            <option>ปราจีนบุรี</option>
                            <option>ปัตตานี</option>
                            <option>พระนครศรีอยุธยา</option>
                            <option>พะเยา</option>
                            <option>พังงา</option>
                            <option>พัทลุง</option>
                            <option>พิจิตร</option>
                            <option>พิษณุโลก</option>
                            <option>เพชรบุรี</option>
                            <option>เพชรบูรณ์</option>
                            <option>แพร่</option>
                            <option>ภูเก็ต</option>
                            <option>มหาสารคาม</option>
                            <option>มุกดาหาร</option>
                            <option>แม่ฮ่องสอน</option>
                            <option>ยโสธร</option>
                            <option>ยะลา</option>
                            <option>ร้อยเอ็ด</option>
                            <option>ระนอง</option>
                            <option>ระยอง</option>
                            <option>ราชบุรี</option>
                            <option>ลพบุรี</option>
                            <option>ลำปาง</option>
                            <option>ลำพูน</option>
                            <option>เลย</option>
                            <option>ศรีสะเกษ</option>
                            <option>สกลนคร</option>
                            <option>สงขลา</option>
                            <option>สตูล</option>
                            <option>สมุทรปราการ</option>
                            <option>สมุทรสงคราม</option>
                            <option>สมุทรสาคร</option>
                            <option>สระแก้ว</option>
                            <option>สระบุรี</option>
                            <option>สิงห์บุรี</option>
                            <option>สุโขทัย</option>
                            <option>สุพรรณบุรี</option>
                            <option>สุราษฎร์ธานี</option>
                            <option>สุรินทร์</option>
                            <option>หนองคาย</option>
                            <option>หนองบัวลำภู</option>
                            <option>อ่างทอง</option>
                            <option>อำนาจเจริญ</option>
                            <option>อุดรธานี</option>
                            <option>อุตรดิตถ์</option>
                            <option>อุทัยธานี</option>
                            <option>อุบลราชธานี</option>
                        </select>
                    </div>
                    <div>
                        <label class="form-label" for="vehicleColor">สีรถ</label>
                        <input class="form-input" id="vehicleColor" type="text" placeholder="เช่น ขาว, ดำ-แดง" required>
                        <p class="text-xs text-gray-500 mt-1">ระบุสีตามคู่มือรถ หรือสีที่เห็นชัดเจนที่สุด 2 สี</p>
                    </div>
                </div>

                <!-- Image Uploads -->
                <div class="mt-6 grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="form-label" for="frontImage">ภาพถ่ายรถด้านหน้า</label>
                        <input class="form-input" type="file" id="frontImage" accept="image/*" required>
                        <img id="frontImagePreview" class="image-preview" alt="ภาพถ่ายรถด้านหน้า">
                    </div>
                    <div>
                        <label class="form-label" for="backImage">ภาพถ่ายรถด้านหลัง</label>
                        <input class="form-input" type="file" id="backImage" accept="image/*" required>
                        <img id="backImagePreview" class="image-preview" alt="ภาพถ่ายรถด้านหลัง">
                    </div>
                    <div>
                        <label class="form-label" for="leftImage">ภาพถ่ายรถด้านข้าง (ซ้าย)</label>
                        <input class="form-input" type="file" id="leftImage" accept="image/*" required>
                        <img id="leftImagePreview" class="image-preview" alt="ภาพถ่ายรถด้านซ้าย">
                    </div>
                    <div>
                        <label class="form-label" for="rightImage">ภาพถ่ายรถด้านข้าง (ขวา)</label>
                        <input class="form-input" type="file" id="rightImage" accept="image/*" required>
                        <img id="rightImagePreview" class="image-preview" alt="ภาพถ่ายรถด้านขวา">
                    </div>
                </div>
            </div>

            <!-- Confirmation -->
            <div class="form-section">
                <div class="flex items-start">
                    <input id="confirmation" type="checkbox" class="h-5 w-5 text-green-600 border-gray-300 rounded focus:ring-green-500 mt-1">
                    <label for="confirmation" class="ml-3 block text-sm text-gray-800">
                        ขอรับรองว่าข้อมูลถูกต้องและเป็นความจริงทุกประการ หากมีเจตนาให้ข้อมูลเท็จ ข้าพเจ้ายินดีรับโทษตามระเบียบและข้อบังคับของมหาวิทยาลัยทุกประการ
                    </label>
                </div>
            </div>

            <!-- Submit Button -->
            <button id="submitBtn" type="submit" class="btn-submit" disabled>
                ส่งข้อมูล
            </button>
        </form>
    </div>

    <script>
        // =================================================================
        // CONFIGURATION
        // TODO: วาง URL ใหม่ที่ได้จากการ Deploy ในขั้นตอนที่ 2 ที่นี่
        // =================================================================
        const GAS_URL = 'YOUR_NEW_WEB_APP_URL_HERE';

        // =================================================================
        // DOM ELEMENTS (No changes here)
        // =================================================================
        const form = document.getElementById('vehicleForm');
        const submitBtn = document.getElementById('submitBtn');
        const confirmationCheckbox = document.getElementById('confirmation');
        const studentIdInput = document.getElementById('studentId');
        const phoneInput = document.getElementById('phone');
        const emergencyPhoneInput = document.getElementById('emergencyPhone');
        const studentIdError = document.getElementById('studentIdError');
        const phoneError = document.getElementById('phoneError');
        const emergencyPhoneError = document.getElementById('emergencyPhoneError');
        const imageInputs = {
            frontImage: document.getElementById('frontImagePreview'),
            backImage: document.getElementById('backImagePreview'),
            leftImage: document.getElementById('leftImagePreview'),
            rightImage: document.getElementById('rightImagePreview'),
        };

        // =================================================================
        // VALIDATION LOGIC (No changes here)
        // =================================================================
        const validators = {
            studentId: (value) => /^\d{8}$/.test(value),
            phone: (value) => /^0\d{9}$/.test(value),
        };
        function validateField(input, errorElement, validator) {
            if (validator(input.value)) {
                errorElement.classList.add('hidden');
                input.classList.remove('border-red-500');
                return true;
            } else {
                errorElement.classList.remove('hidden');
                input.classList.add('border-red-500');
                return false;
            }
        }
        studentIdInput.addEventListener('input', () => validateField(studentIdInput, studentIdError, validators.studentId));
        phoneInput.addEventListener('input', () => validateField(phoneInput, phoneError, validators.phone));
        emergencyPhoneInput.addEventListener('input', () => validateField(emergencyPhoneInput, emergencyPhoneError, validators.phone));

        // =================================================================
        // IMAGE HANDLING (No changes here)
        // =================================================================
        function handleFileChange(event) {
            const input = event.target;
            const preview = document.getElementById(input.id + 'Preview');
            const file = input.files[0];
            if (file) {
                if (file.size > 10 * 1024 * 1024) {
                    Swal.fire({ icon: 'error', title: 'ไฟล์ใหญ่เกินไป', text: 'กรุณาเลือกไฟล์ภาพขนาดไม่เกิน 10 MB' });
                    input.value = '';
                    return;
                }
                const reader = new FileReader();
                reader.onload = function(e) {
                    preview.src = e.target.result;
                    preview.classList.remove('hidden');
                }
                reader.readAsDataURL(file);
            } else {
                preview.classList.add('hidden');
            }
            checkFormValidity();
        }
        Object.keys(imageInputs).forEach(id => {
            document.getElementById(id).addEventListener('change', handleFileChange);
        });

        // =================================================================
        // FORM SUBMISSION LOGIC (UPDATED)
        // =================================================================
        function checkFormValidity() {
            const isFormValid = form.checkValidity();
            const allValidatorsPass = 
                validateField(studentIdInput, studentIdError, validators.studentId) &&
                validateField(phoneInput, phoneError, validators.phone) &&
                validateField(emergencyPhoneInput, emergencyPhoneError, validators.phone);
            submitBtn.disabled = !(isFormValid && allValidatorsPass && confirmationCheckbox.checked);
        }
        form.addEventListener('input', checkFormValidity);
        confirmationCheckbox.addEventListener('change', checkFormValidity);

        function toBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = () => resolve(reader.result);
                reader.onerror = error => reject(error);
            });
        }

        form.addEventListener('submit', async function(e) {
            e.preventDefault();
            checkFormValidity();
            if (submitBtn.disabled) {
                 Swal.fire('ข้อมูลไม่ครบถ้วน', 'กรุณากรอกข้อมูลที่จำเป็นให้ครบถ้วนและถูกต้อง', 'warning');
                 return;
            }

            if (GAS_URL === 'YOUR_NEW_WEB_APP_URL_HERE') {
                Swal.fire('ตั้งค่าไม่สมบูรณ์', 'กรุณาใส่ Web App URL ในไฟล์ index.html', 'error');
                return;
            }

            Swal.fire({
                title: 'กำลังส่งข้อมูล...',
                text: 'กรุณารอสักครู่ ระบบกำลังอัปโหลดรูปภาพ',
                allowOutsideClick: false,
                didOpen: () => {
                    Swal.showLoading();
                }
            });

            try {
                const [frontImage, backImage, leftImage, rightImage] = await Promise.all([
                    toBase64(document.getElementById('frontImage').files[0]),
                    toBase64(document.getElementById('backImage').files[0]),
                    toBase64(document.getElementById('leftImage').files[0]),
                    toBase64(document.getElementById('rightImage').files[0])
                ]);

                const payload = {
                    studentId: studentIdInput.value,
                    fullName: document.getElementById('fullName').value,
                    faculty: document.getElementById('faculty').value,
                    phone: phoneInput.value,
                    residence: document.getElementById('residence').value,
                    address: document.getElementById('address').value,
                    emergencyContactName: document.getElementById('emergencyContactName').value,
                    emergencyRelationship: document.getElementById('emergencyRelationship').value,
                    emergencyPhone: emergencyPhoneInput.value,
                    license: document.getElementById('license').value,
                    vehicleType: document.getElementById('vehicleType').value,
                    vehicleBrand: document.getElementById('vehicleBrand').value,
                    vehicleModel: document.getElementById('vehicleModel').value,
                    licensePlate: document.getElementById('licensePlate').value,
                    province: document.getElementById('province').value,
                    vehicleColor: document.getElementById('vehicleColor').value,
                    frontImage,
                    backImage,
                    leftImage,
                    rightImage,
                    frontImageName: document.getElementById('frontImage').files[0].name,
                    backImageName: document.getElementById('backImage').files[0].name,
                    leftImageName: document.getElementById('leftImage').files[0].name,
                    rightImageName: document.getElementById('rightImage').files[0].name,
                };

                const response = await fetch(GAS_URL, {
                    method: 'POST',
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    throw new Error(`Server responded with status: ${response.status}`);
                }
                
                const result = await response.json();

                if (result.status === 'success') {
                    Swal.fire({
                        icon: 'success',
                        title: 'บันทึกข้อมูลสำเร็จ!',
                        text: result.message,
                    });
                    form.reset();
                    Object.values(imageInputs).forEach(preview => preview.classList.add('hidden'));
                    checkFormValidity();
                } else {
                    throw new Error(result.message || 'เกิดข้อผิดพลาดจากเซิร์ฟเวอร์');
                }

            } catch (error) {
                console.error('Fetch Error:', error);
                Swal.fire({
                    icon: 'error',
                    title: 'เกิดข้อผิดพลาด',
                    text: `ไม่สามารถส่งข้อมูลได้ กรุณาตรวจสอบการเชื่อมต่ออินเทอร์เน็ตและลองใหม่อีกครั้ง (Details: ${error.message})`,
                });
            }
        });
    </script>
</body>
</html>
